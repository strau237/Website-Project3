YUI.add("search-subnav-slender-view",function(e){var r=[{id:"photos",intlKey:"search.PHOTOS",searchType:e.SearchUrl.searchTypes.PHOTOS},{id:"people",intlKey:"search.PEOPLE",searchType:e.SearchUrl.searchTypes.PEOPLE},{id:"groups",intlKey:"search.GROUPS",searchType:e.SearchUrl.searchTypes.GROUPS}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(a){var t,s=this,h=a.modelParams&&a.modelParams.apiParams?e.merge(a.modelParams.apiParams):{},i=[];return this.set("searchType",a.searchType),this.set("searchUrl",new e.SearchUrl(h,this.appContext,this.get("searchType"))),this.set("showAdvancedClearLink",this.get("searchType")===e.SearchUrl.searchTypes.PHOTOS&&this.get("searchUrl").hasAdvancedParams(!1)),r.forEach(function(r){(t=e.merge(r,{title:s.intlMessage({intlName:r.intlKey}),url:s.buildTabUrl(r.id,r.searchType),selected:r.searchType===s.get("searchType")})).selected&&(s.set("currentTabUrl",t.url),s.set("currentTabId",t.id)),i.push(t)}),this.set("links",i),this},buildContainer:function(){return this.setContainerWithTemplate("search-subnav",{showInactiveToggle:!1,showTools:!1,selectedSort:!1,showSort:!1,showAdvanced:!1,usingSlenderAdvancedPanel:!0,links:this.get("links"),showAdvancedClearLink:this.get("showAdvancedClearLink")}),this},activate:function(){return e.SearchUrl.isSearchUrl(this.appContext.getPreviousURL())||this.clearStoredTabUrls(),this.get("currentTabUrl")&&this.get("currentTabId")&&this.storeTabUrl(this.get("currentTabUrl"),this.get("currentTabId")),this.get("showAdvancedClearLink")&&this.registerEventHandler(this.get("container").one(".advanced-clear-link").on("click",this.handleClearAdvancedSearchClick.bind(this))),this},buildTabUrl:function(r,a){var t,s=a!==this.get("searchType")?this.checkForStoredUrl(r):null,h=this.get("searchUrl").getSearchTerm();return s?h!==(t=new e.SearchUrl(s,this.appContext,a)).getSearchTerm()&&t.removeScope().resetToUnified().setSearchTerm(h):(t=this.get("searchUrl").clone().setSearchType(a),a!==this.get("searchType")&&(t.removeAPIParam(e.SearchHelper.API.sort),t.removeAPIParam(e.SearchHelper.API.safeSearch)),a!==e.SearchUrl.searchTypes.PHOTOS&&t.removeScope()),t.getURL()},checkForStoredUrl:function(r){var a,t;return YUI.Env.isServer||(t=this.getStorageKeyFromTabId(r),a=e.StorageHelper.getItem(t,!0)),a},clearStoredTabUrls:function(){var r,a=this;YUI.Env.isServer||this.get("links").forEach(function(t){r=a.getStorageKeyFromTabId(t.id),e.StorageHelper.remove(r,!0)})},storeTabUrl:function(r,a){var t;YUI.Env.isServer||(t=this.getStorageKeyFromTabId(a),e.StorageHelper.setItem(t,r,!0))},getStorageKeyFromTabId:function(e){return"searchUrl-"+e},handleClearAdvancedSearchClick:function(r){var a,t=this.get("searchUrl").getSearchTerm(),s=this.get("searchUrl").getAPIParams();r.halt(),e.SearchHelper.clearParamsExceptSearchScope(s),delete s[e.SearchHelper.API.commons],a=new e.SearchUrl(s,this.appContext,this.searchType),t&&a.setSearchTerm(t),this.appContext.flapp.navigate(a.getURL())}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-subnav","storage-helper","search-helper","search-url"],langBundles:["search"]});YUI.add("hermes-lang-search",function(e,o){e.Intl.add("hermes/search","en-US",{RELEVANT:["Relevant"],RECENT:["Recent"],INTERESTING:["Interesting"],NAME:["Name"],ACTIVITY:["Activity"],SIZE:["Size"],OLDEST:["Oldest"],NEWEST:["Newest"],DEFAULT_SEARCH:['This is where you search Flickr. Here\'s a search for <span class="default-search">',"${query}","</span> to get you started!"],FLICKR_SEARCH:["Flickr Search"],NO_MATCHES_FOR_QUERY_TERM:["Oops! There are no matches for “","${searchTerm}","”."],NO_MATCHES_FOR_QUERY_TERM_WITH_SETTINGS:["Oops! There are no matches for “","${searchTerm}","” with your selected settings."],NO_MATCHES_FOR_QUERY:["Oops! There are no matches for your search."],TRY_DIFFERENT:["Please try refining your search."],TRY_DIFFERENT_BROADER:["Please try broadening your search."],SEARCH_ERROR:["Oops! The date you entered does not exist."],SEARCH_START:["Start your search"],SEARCHING:["Searching"],FETCHING_PHOTOS:["Fetching more photos..."],SEARCH:["Search"],START_YOUR_SEARCH:["Start your search"],BY_USER:["by ","${user}"],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_YOUR:["Oops! There are no matches for “","${searchTerm}","” in your photos."],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_CONTACTS:["Oops! There are no matches for “","${searchTerm}","” in your contacts' photos."],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_USER:["Oops! There are no matches for “","${searchTerm}","” in this user's photos."],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_GROUP:["Oops! There are no matches for “","${searchTerm}","” in this group."],NO_MATCHES_FOR_QUERY_TERM_YOUR:["Oops! There are no matches for your search in your photos."],NO_MATCHES_FOR_QUERY_TERM_CONTACTS:["Oops! There are no matches for your search in your contacts' photos."],NO_MATCHES_FOR_QUERY_TERM_USER:["Oops! There are no matches for your search in this user's photos."],NO_MATCHES_FOR_QUERY_TERM_GROUP:["Oops! There are no matches for your search in this group."],API_ERROR_HEADER:["Oh noes! We couldn't process your search."],API_ERROR_SUBHEADER:["Please change it up a bit and try again."],PEOPLE_YOU_FOLLOW:["People you follow"],ALL_FLICKR_MEMBERS:["All Flickr members"],FLICKR_MEMBERS:["Flickr members"],YOUR_GROUPS:["Your groups"],ALL_FLICKR_GROUPS:["All Flickr groups"],FLICKR_GROUPS:["Flickr groups"],MEMBER_COUNT:[{type:"plural",valueName:"count",options:{zero:"0 members",one:"${#} member",other:"${#} members"}}],GROUP_PHOTO_COUNT:[{type:"plural",valueName:"count",options:{zero:"no photos",one:"${#} photo",other:"${#} photos"}}],GROUP_DISCUSSION_COUNT:[{type:"plural",valueName:"count",options:{zero:"no discussions",one:"${#} discussion",other:"${#} discussions"}}],YOUR_PHOTOS:["Your photos"],YOUR_ALBUMS:["Your albums"],YOUR_GALLERIES:["Your galleries"],FROM_YOUR_CONTACTS:["From your contacts"],EVERYONES_PHOTOS:["Everyone's photos"],VIEW_ALL_COUNT:[{type:"plural",valueName:"count",options:{zero:"no more photos",other:"View all ${#}"}}],RESULTS_COUNT:[{type:"plural",valueName:"count",options:{zero:"no results",one:"${#} result",other:"${#} results"}}],PEOPLE_PHOTOS_COUNT:[{type:"plural",valueName:"count",options:{zero:"0 photos",one:"${#} photo",other:"${#} photos"}}],PEOPLE_VIDEOS_COUNT:[{type:"plural",valueName:"count",options:{zero:"no videos",one:"${#} video",other:"${#} videos"}}],PEOPLE_FOLLOWERS_COUNT:[{type:"plural",valueName:"count",options:{zero:"no followers",one:"${#} follower",other:"${#} followers"}}],SAFESEARCH_ON:["SafeSearch on"],SAFESEARCH_OFF:["SafeSearch off"],SAFESEARCH_MODERATE:["SafeSearch moderate"],SEARCH_PHOTOSTREAM:["Search photostream"],SEARCH_FAVORITES:["Search favorites"],ANY_LICENSE:["Any license"],ALL_CC:["All creative commons"],COMMERCIAL_USE:["Commercial use allowed"],MODS_ALLOWED:["Modifications allowed"],COMMERCIAL_USE_MODS:["Commercial use & mods allowed"],NO_RESTRICTIONS:["No known copyright restrictions"],MARKETPLACE_LICENSE:["Flickr Marketplace"],US_GOVT:["U.S. Government works"],PUBLIC_DOMAIN_DEDICATION:["Public Domain Dedication (CC0)"],PUBLIC_DOMAIN_WORK:["Public Domain Work"],CC_BY_NC_SA:["Attribution-NonCommercial-ShareAlike"],CC_BY_NC:["Attribution-NonCommercial"],CC_BY_NC_ND:["Attribution-NonCommercial-NoDerivs"],CC_BY:["Attribution"],CC_BY_SA:["Attribution-ShareAlike"],CC_BY_ND:["Attribution-NoDerivs"],PLAIN_COUNT:[{type:"plural",valueName:"count",options:{zero:"0",one:"${#}",other:"${#}"}}],PHOTOS:["Photos"],PEOPLE:["People"],GROUPS:["Groups"],PHOTOS_POSSESSIVE:["${name}","'s photos"],FAVES_POSSESSIVE:["${name}","'s favorites"],CONTACTS_POSSESSIVE:["${name}","'s contacts"],GROUPS_POSSESSIVE:["${name}","'s groups"],VIEWER_FAVES:["Your favorites"],IN_GROUP_POOL:["In the ","${name}"," group pool"],OPT_OUT_MESSAGE:["You are viewing the alpha version of our new search experience. Click here to return to the old version."],OPT_IN_MESSAGE:["Go back to the alpha search experience"],OPT_OUT_MESSAGE_BETA:["You are viewing the beta version of our new search experience. Click here to return to the old version."],OPT_IN_MESSAGE_BETA:["Go back to the beta search experience"],SEARCH_BETA_LABEL:["Search beta"],SEARCH_ALPHA_LABEL:["Search alpha"],GO_BACK_TO_OLD_SEARCH:["Go back to the old Flickr search"],PROVIDE_FEEDBACK:["Provide feedback"],FROM_PEOPLE_YOU_FOLLOW:["From people you follow"],FULL_TEXT_AND_TAGS:["Full text with suggested tags"],FULL_TEXT:["Full text"],TAGS_ONLY:["Tags only"],RED:["Red"],DARK_ORANGE:["Dark orange"],ORANGE:["Orange"],SCHOOL_BUS_YELLOW:["School bus yellow"],LEMON_YELLOW:["Lemon yellow"],GREEN:["Green"],LIME_GREEN:["Dark lime green"],CYAN:["Cyan"],BLUE:["Blue"],VIOLET:["Violet"],PINK:["Pink"],PALE_PINK:["Pale pink"],WHITE:["White"],GRAY:["Gray"],BLACK:["Black"],MONOCHROME:["monochrome"],JOINED_DATE:["Joined ",{type:"date",valueName:"intlDate",format:"monthYearShort"}],HIDE_INACTIVE_GROUPS:["Hide inactive groups"],ADVANCED:["Advanced"],ORIENTATION_AND_SIZE:["Orientation & size"],ORIENTATION:["Orientation"],MINIMUM_SIZE:["Minimum size"],PORTRAIT:["Portrait"],SQUARE:["Square"],LANDSCAPE:["Landscape"],PANORAMA:["Panorama"],SMALL_SHOW_ALL_SIZES:["Small (show all sizes)"],ALL_SIZES:["All sizes"],MEDIUM:["Medium"],LARGE:["Large"],CUSTOM:["Custom"],COLOR:["Color"],DATE:["Date"],FROM:["From"],TO:["To"],DATE_TAKEN:["Date taken"],DATE_POSTED:["Date posted"],DATE_UPLOADED:["Date uploaded"],CONTENT:["Content"],VIDEOS:["Videos"],SCREENSHOTS:["Screenshots"],ILLUSTRATIONS:["Illustrations"],SEARCH_IN:["Search in"],RESET:["Reset"],JUSTIFIED_VIEW:["Justified view"],THUMBNAIL_VIEW:["Thumbnail view"],TILE_VIEW:["Tile view"],SORT:["Sort"],TOGGLE_ADVANCED:["Toggle advanced"],CAMERA_SETTINGS:["Camera settings"],TOGGLE_SEARCH:["Toggle Search"],PHOTOS_PEOPLE_OR_GROUPS:["Photos, people, or groups"],PHOTOS_PEOPLE_GROUPS:["Photos, people, groups"],SMALL_SHORT:["S"],MEDIUM_SHORT:["M"],LARGE_SHORT:["L"],ALL:["All"],TAGS:["Tags"],CLEAR:["Clear"],ABSTRACT:["Abstract"],ART:["Art"],BLACK_AND_WHITE:["Black and white"],MONOCHROME_STYLE:["Monochrome"],BLUR:["Blur"],BRIGHT:["Bright"],CURVES:["Curves"],DIAGONAL:["Diagonal"],ETHEREAL:["Ethereal"],GEOMETRIC:["Geometric"],HDR:["HDR"],LINES:["Lines"],MACRO:["Macro"],DEPTH_OF_FIELD:["Shallow depth of field"],MINIMALIST:["Minimalist"],PASTEL:["Pastel"],PATTERNS:["Patterns"],ROUND:["Round"],SERENE:["Serene"],SYMMETRY:["Symmetry"],TEXTURES:["Textures"],TRIANGLES:["Triangles"],VINTAGE:["Vintage"],BOKEH:["Bokeh"],SEARCH_PHOTOS:["Search photos"],SEARCH_PEOPLE:["Search people"],SEARCH_GROUPS:["Search groups"],EVERYONE:["Everyone"],SIGN_IN_BEFORE_SEARCH_TITLE:["This content is for mature audiences only."],SIGN_IN_BEFORE_SEARCH_MESSAGE:["Join Flickr to turn off safe search."],SIGNUP_FOOTER_MESSAGE:["Private photo management and an inspiring community."]})},"@VERSION@",{requires:["intl"]});YUI.add("attribute-helpers",function(n){function e(n){if(void 0===n||null===n)return!0}n.AttributeHelpers={validateString:function(t){return!!e(t)||!!n.Lang.isString(t)||!!n.Lang.isNumber(t)},coerceString:function(e){return n.Lang.isNumber(e)&&(e=e.toString()),n.Lang.isString(e)?e:void 0},validateInteger:function(t){return!!e(t)||(n.Lang.isString(t)&&(t=parseInt(t,10)),!!n.Lang.isNumber(t))},coerceInteger:function(e){return n.Lang.isString(e)&&(e=parseInt(e,10)),n.Lang.isNumber(e)?e<0?Math.ceil(e):Math.floor(e):void 0},validateFloat:function(t){return!!e(t)||(n.Lang.isString(t)&&(t=parseFloat(t)),!!n.Lang.isNumber(t))},coerceFloat:function(e){if(n.Lang.isString(e)&&(e=parseFloat(e)),n.Lang.isNumber(e))return e},validateBoolean:function(t){return!!e(t)||!!n.Lang.isBoolean(t)||[0,"0","false"].indexOf(t)>-1||[1,"1","true"].indexOf(t)>-1},coerceBoolean:function(n){return!([!1,"0",0,"false"].indexOf(n)>-1)&&([!0,"1",1,"true"].indexOf(n)>-1||void 0)},validateDate:function(t){return!!e(t)||-1===[!0,!1].indexOf(t)&&!(t instanceof Array)&&("string"==typeof t&&(t=parseInt(t,10)),"object"==typeof t&&void 0!==t._d&&(t=t._d),!!n.moment(t).isValid())},coerceDate:function(e){var t=null,i=null;return n.moment.isMoment(e)?e:e&&"object"==typeof e&&e._d&&((i=n.moment(e)).isValid()||(i=n.moment(e._d)),i.isValid())?i:"number"==typeof e||e===parseInt(e,10).toString()?(t=parseInt(e,10),i=t.toString().length<=10?n.moment(t.toString(),"X"):n.moment(t)):e&&!n.Lang.isBoolean(e)&&(n.moment(new Date(e)).isValid()||n.moment(new Date(e.toString().replace(" ","T"))).isValid())?n.moment(e):void 0}}},"@VERSION@",{requires:[]});YUI.add("hermes-template-search-empty",function(e,a){var t=e.Template.Handlebars.revive({1:function(e,a,t,n,s){return" using-slender-advanced-panel"},3:function(e,a,t,n,s){var l,r=e.escapeExpression;return'\t\t\t<div class="no-results-message">\n\t\t\t\t<h5>'+r(e.lambda(null!=(l=null!=a?a.noMatchesForQuery:a)?l.noMatchesText:l,a))+"</h5>\n\t\t\t\t<h5>"+r((t.intlMessage||a&&a.intlMessage||t.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"search.TRY_DIFFERENT_BROADER"},data:s}))+"</h5>\n\t\t\t</div>\n"},5:function(e,a,t,n,s){var l=null!=a?a:{},r=t.helperMissing,i=e.escapeExpression;return'\t\t\t<div class="no-results-message">\n\t\t\t\t<h5>'+i((t.intlMessage||a&&a.intlMessage||r).call(l,{name:"intlMessage",hash:{intlName:"search.API_ERROR_HEADER"},data:s}))+"</h5>\n\t\t\t\t<h5>"+i((t.intlMessage||a&&a.intlMessage||r).call(l,{name:"intlMessage",hash:{intlName:"search.API_ERROR_SUBHEADER"},data:s}))+"</h5>\n\t\t\t</div>\n"},compiler:[7,">= 4.0.0"],main:function(e,a,t,n,s){var l,r,i=null!=a?a:{},c=t.helperMissing,h=e.escapeExpression;return'<div class="search-empty'+(null!=(l=t.if.call(i,null!=a?a.usingSlenderAdvancedPanel:a,{name:"if",hash:{},fn:e.program(1,s,0),inverse:e.noop,data:s}))?l:"")+'">\n\t<div class="no-results-message-container">\n'+(null!=(l=t.if.call(i,null!=a?a.noMatchesForQuery:a,{name:"if",hash:{},fn:e.program(3,s,0),inverse:e.noop,data:s}))?l:"")+(null!=(l=t.if.call(i,null!=a?a.apiFailed:a,{name:"if",hash:{},fn:e.program(5,s,0),inverse:e.noop,data:s}))?l:"")+'\t</div>\n\n\t<div class="search-box-container">\n\t\t<form method="GET" action="/search/" role="search">\n\t\t\t<div class="search-icon"></div>\n\t\t\t<input type="text" name="text" class="search-box" placeholder="'+h("function"==typeof(r=null!=(r=t.searchPlaceholder||(null!=a?a.searchPlaceholder:a))?r:c)?r.call(i,{name:"searchPlaceholder",hash:{},data:s}):r)+'" role="textbox" autofocus>\n\t\t\t<button type="submit" class="large search-button">'+h((t.intlMessage||a&&a.intlMessage||c).call(i,{name:"intlMessage",hash:{intlName:"search.SEARCH"},data:s}))+"</button>\n\t\t</form>\n\t</div>\n</div>\n"},useData:!0}),n={};e.Array.each([],function(a){var t=e.Template.get("hermes/"+a);t&&(n[a]=t)}),e.Template.register("hermes/search-empty",function(a,s){return s=s||{},s.partials=s.partials?e.merge(n,s.partials):n,t(a,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("search-empty-view",function(e){"use strict";e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(a){var t=a.modelParams&&a.modelParams.apiParams?e.merge(a.modelParams.apiParams):{};this.searchUrl=new e.SearchUrl(t,this.appContext,a.searchType||e.SearchUrl.searchTypes.UNDEFINED),this.searchType=a.searchType,this.isMobile=a.isMobile,""===this.get("container").get("innerHTML")&&this.setContainerHTML("")},buildContainer:function(){var a="search.PHOTOS_PEOPLE_OR_GROUPS";return this.isMobile&&(this.searchType===e.SearchUrl.searchTypes.PHOTOS?a="search.SEARCH_PHOTOS":this.searchType===e.SearchUrl.searchTypes.PEOPLE?a="search.SEARCH_PEOPLE":this.searchType===e.SearchUrl.searchTypes.GROUPS&&(a="search.SEARCH_GROUPS")),a=this.intlMessage({intlName:a}),this.setContainerWithTemplate("search-empty",{searchPlaceholder:a,noMatchesForQuery:this.get("noMatchesForQuery"),apiFailed:this.get("apiFailed"),usingSlenderAdvancedPanel:this.appContext.flipper.isFlipped("enable-slender-advanced-search")}),this},activate:function(){var e,a,t=this.get("container").one(".search-box-container form"),r=this;return e=t.one("input.search-box"),this.isMobile||this.registerEventHandler(e.on("keyup",this.handleSearchFieldKeyUp.bind(this))),t&&(this.registerEventHandler(t.on("submit",function(t){a=r.searchUrl.createNewSearch(e.get("value")).getURL(),t.halt(),r.appContext.flapp.navigate(a)})),setTimeout(function(){e.focus()},500)),this},enableBlankState:function(e){this.get("container").addClass("blank")},handleSearchFieldKeyUp:function(a){var t=a.target,r=t.get("value");r.length>0&&(this.enableBlankState(),e.fire("transfer-to-gn-search",r),t.set("value",""))},onParentViewEvent:function(e,a){a&&"error-msg-updated"===a[0]&&this.isBuilt&&this.buildContainer()}},{ATTRS:{noMatchesForQuery:{value:!1,validator:function(e,a){return!e||"object"==typeof e&&e.hasOwnProperty("noMatchesText")}},apiFailed:{value:!1,validator:function(a,t){return e.AttributeHelpers.validateBoolean(a)}}}})},"@VERSION@",{requires:["flickr-view","flickr-promise","search-url","attribute-helpers","hermes-template-search-empty"],langBundles:["search"]});YUI.add("model-proxy",function(e,t){var r=require("hermes-core/flog")(t);e.getModelProxyConstructor=function(t){var o;return o=function(e){this.id=e,this.registry=t,this.isModel=!0},o.prototype={},e.getModelProxyConstructor.skipList.forEach(function(e){o.prototype[e]=function(){var t=new Error("Registry methods are not exposed on models.");throw r.error({err:t,method:e}),t}}),e.Object.each(t,function(r,n){o.prototype[n]||0!==n.indexOf("_")&&e.Lang.isFunction(r)&&(Object.keys(r.prototype).length>0||(o.prototype[n]=(function(e){return function(){for(var r=new Array(arguments.length),o=0;o<r.length;++o)r[o]=arguments[o];return r.unshift(this.id),t[e].apply(t,r)}})(n)))},this,!0),o},e.getModelProxyConstructor.skipList=["add","get","load","proxy","remoteRead","remoteCreate","attributeSearch","removeAll","getCount","serialize","deserialize"]},"@VERSION@",{requires:[]});YUI.add("flickr-collection",function(t){var i,n={};(i=t.FlickrCollection=function(t,i,n){this.registry=t,this.id=i,this.attrName=n,this._data=[],this.fetchedStart=!1,this.fetchedEnd=!1,this.totalItems=Number.MAX_VALUE}).prototype={constructor:i,push:function(t){var i=this._data.concat();i.push(t),this.registry.setValue(this.id,this.attrName,i)},unshift:function(t){var i=this._data.concat();i.unshift(t),this.registry.setValue(this.id,this.attrName,i)},concat:function(t){var i=this._data.concat(t);this.registry.setValue(this.id,this.attrName,i)},remove:function(t){"string"==typeof t&&(t={id:t});var i,n=this.find(t,!0);return n&&((i=this._data.concat()).splice(n.index,1),this.registry.setValue(this.id,this.attrName,i)),n&&n.value},find:function(t,i){if(!t)return null;var n=null,e=Object.keys(t);return this._data.some(function(i,r){if(i)return e.every(function(n){return i[n]===t[n]})?(n={value:i,index:r},!0):void 0}),i?n:n?n.value:null},getFirstItem:function(){var t,i;for(t=0;t<this._data.length;t++)if(i=this._data[t])return{item:i,index:t};return null},getLastItem:function(){var t,i;for(t=this._data.length-1;t>=0;t--)if(i=this._data[t])return{item:i,index:t};return null},getList:function(){return this._data.concat()},size:function(){return this._data.length},toJSON:function(){var i=[];return t.Array.each(this.getList(),function(t){t&&i.push(t.toJSON())}),i},toString:function(){return this.registry.name+'["'+this.attrName+'"]'},appendToListMulti:function(t){this.concat(t)},appendToList:function(t){this.push(t)},prependToList:function(t){this.unshift(t)},getFromListByID:function(t,i){var n={};return n[i||"id"]=t,this.find(n)||void 0},removeFromList:function(t,i){var n={};return n[i||"id"]=t,this.remove(n)},hasMinBoundary:function(){return this.fetchedStart},hasMaxBoundary:function(){return this.fetchedEnd},_setValue:function(t){this._data=t}},t.FlickrCollection.executeFetch=function(i,e,r,a){var s;return a&&t.Lang.isFunction(a.run)?(s=JSON.stringify(i),n[s]||(n[s]=a.run.call(a,i,e.appContext).then(function(t){return delete n[s],t},function(t){throw delete n[s],t}),n[s])):t.Promise.reject("(flickr-collection::executeFetch) invalid fetcher for "+e.name+"["+r+"]")},t.FlickrCollection.trimArray=function(t){for(var i=0,n=t.length-1;i<t.length&&!t[i];)i++;for(;n>i&&!t[n];)n--;return t.slice(i,n+1)}},"@VERSION@",{requires:[]});YUI.add("paged-collection",function(t,e){var a=require("hermes-core/flog")(e);t.PagedCollection=function(t,e,a,s){this.constructor.superclass.constructor.call(this,t,e,a),s&&(s instanceof Array&&(s={pageContent:s,page:1,perPage:s.length}),s.totalPages&&(this.totalPages=s.totalPages),void 0===typeof s.totalItems||isNaN(parseFloat(s.totalItems))||(this.totalItems=parseFloat(s.totalItems)),this.fetchedStart=!!s.fetchedStart,this.fetchedEnd=!!s.fetchedEnd,this.addPage(s))},t.extend(t.PagedCollection,t.FlickrCollection,{getPage:function(e){var a,s,i,o,r,n,h;if(e&&e.page&&e.perPage&&!e.forceAPICall){if(n=this.totalPages&&e.page>=this.totalPages,h=this.totalItems&&s>=this.totalItems,a=e.perPage*(e.page-1),s=Math.min(e.perPage*e.page,this.totalItems),!n&&!h||!this.fetchedEnd)for(i=a;i<s;i++)if(void 0===this._data[i]||!this._data[i].exists()){o=!0;break}}else e||(e={}),o=!0;return o?(e.pathAlias||(e.id=this.id),e.isCollection=!0,(r=this.registry.attributes[this.attrName].pageFetch).fetchParams&&(e=t.merge(e,r.fetchParams)),t.FlickrCollection.executeFetch(e,this.registry,this.attrName,r.listFetcher)):t.Promise.resolve(this._data.slice(a,s))},addPage:function(t){var e,a,s=t.perPage*(t.page-1),i=s+Math.min(t.pageContent.length,t.perPage),o=0;if(t.forceAppend)this._data=this._data.concat(t.pageContent);else if(this._data.length<=s)this._data.length=s,this._data=this._data.concat(t.pageContent);else for(this._data.length<i&&(this._data.length=i),e=s;e<i;e++)this._data[e]=t.pageContent[o],o++;t.totalPages&&(this.totalPages=t.totalPages,t.page>=this.totalPages&&(this.fetchedEnd=!0)),void 0===typeof t.totalItems||isNaN(parseFloat(t.totalItems))||(a=parseFloat(t.totalItems),this.totalItems=a,this._data.length>=a?this.fetchedEnd=!0:s+parseInt(t.perPage,10)>a&&this._data.length<a&&(this.fetchedEnd=!0)),this.fetchedStart=this._data&&void 0!==this._data[0]},removePage:function(t){},getPageOf:function(t,e){e||(a.warn("`perPage` must be specified; defaulting to 50."),e=50);var s=this.find(t,!0);return s?Math.floor(s.index/e)+1:-1},getNextIncompletePage:function(t){var e=t.page*(t.perPage-1),a=Math.floor(this._data.length/t.perPage)+1;for(e;e<this._data.length;e++)if(void 0===this._data[e]||!this._data[e].exists()){a=Math.floor(e/t.perPage)+1;break}return a},_setValue:function(e){if(e instanceof Array)this.constructor.superclass._setValue.call(this,e);else{if(!(e=(function(e){return e?(e instanceof Array&&(e={pageContent:e}),e=t.merge({page:1,perPage:0,pageContent:[]},e)):(a.warn("No pageData sent to PagedCollection; aborting."),null)})(e)))return;e.remove?this.removePage(e):this.addPage(e)}}})},"@VERSION@",{requires:["flickr-collection"]});YUI.add("flickr-model-registry",function(e,t){function i(t,s,a){return!1===a&&"string"==typeof t&&"string"==typeof s&&(t=t.toLowerCase(),s=s.toLowerCase()),t===s||(e.moment.isMoment(t)&&e.moment.isMoment(s)?0===t.diff(s):!!(e.Lang.isArray(t)&&e.Lang.isArray(s)&&(function(t,s){var a=!0;t.length!==s.length&&(a=!1);a&&e.Array.some(t,function(e,t){if(!i(s[t],e))return a=!1,!0});return a})(t,s))||!!(e.Lang.isObject(t,!0)&&e.Lang.isObject(s,!0)&&(function(t,s){var a=!0;e.Object.size(t)!==e.Object.size(s)&&(a=!1);a&&e.Object.some(t,function(e,t){if(!s.hasOwnProperty(t)||!i(s[t],e))return a=!1,!0});a&&e.Object.some(s,function(e,s){if(!t.hasOwnProperty(s)||!i(t[s],e))return a=!1,!0});return a})(t,s)))}function s(t){var i=t;return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Array.prototype?(i=t.slice(),void 0!==t.hasMinBoundary&&(i.hasMinBoundary=t.hasMinBoundary),void 0!==t.hasMaxBoundary&&(i.hasMaxBoundary=t.hasMaxBoundary)):Object.getPrototypeOf(t)===Object.prototype&&(i={},e.Object.each(t,function(e,t){i[t]=e},this))),i}var a=require("hermes-core/flog")(t);e.Models={};var r=e.FlickrModelRegistry=function(t){this.appContext=t,this.attributes=this.attributes||{},this.attributes.id={writeOnce:"initOnly",setter:function(t){return e.Lang.isString(t)||(e.Lang.isNumber(t)?t+="":(a.info("`id` falling back to a Y.guid",{topic:this.name,val:t}),t=e.guid())),t}},this._setDefaultRemoteMethods(),this._validateAttributes(),this._data={},this._dataSize=0,this._subscribers=[],this.hasWeakSubscribers=!1,this._chainedEvents={},this._derivedCache=void 0,this._unsavedModels={}};r.prototype={attributeSearch:function(t,s){var a=[];return t.id?a.push(t.id):e.Object.each(this._data,function(r,n){var o=!0;e.Object.some(t,function(e,t){if(!i(e,r[t],!1)){if(!0!==s)return o=!1,!0;if(!i(e,this.getDefaultValue(r.id,t),!1))return o=!1,!0}},this),o&&a.push(n)},this),a},load:function(t,i){var s,a,r=this;return i||(i={}),e.Lang.isObject(t,!0)?(s=this.attributeSearch(t).sort()[0],i=e.merge(t,i||{})):(s=t,i=e.merge({id:s},i)),s&&this.exists(s)?e.Promise.resolve(s):(this._fetchPromises||(this._fetchPromises={}),a=s||JSON.stringify(i),this._fetchPromises[a]?this._fetchPromises[a]:(this._fetchPromises[a]=this.remoteRead(i).then(function(){var e,i,n=s;if(s||(e=r.attributeSearch(t)).length>0&&(n=e[0]),delete r._fetchPromises[a],n&&r.exists(n))return n;throw i=new Error("["+r.name+"] Model ID is missing after fetching."),i.getModelFailure=!0,i}),this._fetchPromises[a]))},get:function(e,t){return this.load(e,t).then(this.proxy.bind(this))},add:function(t,i,s){var r;{if(e.Lang.isObject(t,!0)&&!e.Lang.isArray(t))return void 0===i&&(i=!1),r=this.attributes.id.setter.apply(this,[t.id,void 0]),this._data[r]?a.warn("Attempt to add a model that is already in the registry.",{topic:this.name,id:r}):(this._data[r]={},this._dataSize++,this._queueEvent("modelsAdded",{id:r}),i?this._data[r]=t:Object.keys(this.attributes).forEach(function(e){var i=this.attributes[e],a=t[e];i.readOnly||this.setValue(r,e,a,!0,s)},this),this.appContext.markAsNewlyFetched(this.name,r)),this.proxy(r);a.warn("`add` requires an object",{topic:this.name,data:t})}},remove:function(e){this.exists(e)&&(delete this._data[e],this._dataSize--,this._removeChainedEvents(e),this._removeEventSubscribers(e),this._queueEvent("modelsRemoved",{id:e}))},removeAll:function(){e.Object.each(this._data,function(e,t){this.remove(t)},this)},removeAllExcept:function(t){var i=t.reduce(function(e,t){return e[t]=!0,e},{});e.Object.each(this._data,function(e,t){i[t]||this.remove(t)},this)},_removeChainedEvents:function(t){var i;this._chainedEvents[t]&&(e.Object.each(this._chainedEvents[t],function(t,s){(i=this.attributes[s])&&(i.isModel?t.detach():(i.isListProxy||i.isCollection)&&e.Array.each(t,function(e){e.detach&&e.detach()}))},this),delete this._chainedEvents[t])},_removeEventSubscribers:function(t){var i=[];this._subscribers.length&&(e.Array.each(this._subscribers,function(e,s){e.id===t&&i.push(s)},this),e.Array.each(i,function(e){this._subscribers.splice(e,1)},this))},proxy:function(t){return this._ModelProxy||(this._ModelProxy=e.getModelProxyConstructor(this)),new this._ModelProxy(t)},getValue:function(t,i,r){var n,o,h;if(t&&i)if(this.exists(t)){if(o=this.attributes[i])return o.isListProxy?n=new e.ListProxy(this,t,i):(void 0===(n=this._data[t][i])&&(n=this.getDefaultValue(t,i)),h=o.getter,!r&&h&&(n=h.apply(this,[n,t])),n=s(n)),n;a.warn("`getValue` called for an attribute that isn't defined",{topic:this.name,id:t,attr:i})}else a.warn("`getValue` called for an id that doesn't exist in the registry.",{topic:this.name,id:t,attr:i});else a.warn("`getValue` requires two arguments.",{topic:this.name,id:t,attr:i})},setValue:function(t,r,n,o,h){var d,u,l,c,f,v,g;if(!t||!r||arguments.length<3)a.warn("`setValue` requires three arguments.",{topic:this.name,id:t});else if(this.exists(t))if(d=this.attributes[r])if(d.readOnly)a.warn("Attribute is readOnly.",{topic:this.name,id:t,attr:r});else if("initOnly"!==d.writeOnce||o)if(!0===d.writeOnce&&this._data[t][r])a.warn("Attribute can only be set once.",{topic:this.name,id:t,attr:r});else{if(l=this.getValue(t,r),c=this._data[t][r],d.isListProxy&&(l=c),!h&&d.validator){if(v=d.validator,!e.Lang.isFunction(v))return void a.warn("Attribute has an invalid validator.",{topic:this.name,validator:d.validator,attr:r});if(!v.apply(this,[n,t]))return void a.info("Attribute validation failed.",{topic:this.name,id:t,val:n,attr:r})}n=s(n),!h&&d.setter&&(n=d.setter.apply(this,[n,t])),d.isListProxy&&!e.Lang.isArray(n)&&(n=[]),d.isCollection&&(n?"object"==typeof n&&n instanceof e.PagedCollection||(l?(c=l.getList(),l._setValue(n),n=l):(c=null,n=new e.PagedCollection(this,t,r,n))):n=new e.PagedCollection(this,t,r)),this._isDifferentValue(t,r,n,l)&&(!d.isModel||e.Lang.isObject(n)&&n.isModel?(o||(u=this._getAttributeValuesDerivedBy(t,r)),this._data[t][r]=n,d.isListProxy&&n&&(n.hasMinBoundary&&this.getValue(t,r).setMinBoundary(),n.hasMaxBoundary&&this.getValue(t,r).setMaxBoundary()),(d.isModel||d.isListProxy||d.isCollection)&&this._chainEvents(t,r),o||(f=this.getValue(t,r),d.isListProxy||d.isCollection||this._setUnsaved(t,r,f,l,c),g={id:t,attrName:r,prevVal:l,newVal:f},d.isListProxy?g.listDiff=this._calcListDiff(f,l):d.isCollection&&(g.listDiff=this._calcListDiff(f,c)),this._queueEvent("valuesChanged",g),e.Object.size(u)&&e.Object.each(u,function(e,s){var a=this.getValue(t,s);i(a,e)||(g={id:t,attrName:s,prevVal:e,newVal:a,derivedBy:[r]},(this.attributes[s].isListProxy||this.attributes[s].isCollection)&&(g.listDiff=this._calcListDiff(a,e)),this._queueEvent("valuesChanged",g))},this))):a.warn("Attribute must be a ModelProxy instance.",{topic:this.name,id:t,attr:r}))}else a.warn("Attribute can only be set during initialization.",{topic:this.name,id:t,attr:r});else a.warn("Attribute is not present in the attributes list.",{topic:this.name,id:t,attr:r});else a.warn("`setValue called for an id that is not in the registry.",{topic:this.name,id:t})},setValues:function(t,i){var s={};e.Object.each(i,function(e,i){"id"!==i&&(s[i]=this.setValue(t,i,e))},this)},revertValue:function(e,t){this._unsavedModels[e]&&void 0!==this._unsavedModels[e][t]&&this.setValue(e,t,this._unsavedModels[e][t].lastSavedValRaw)},exists:function(t){var i;return i=e.Lang.isArray(t)?t[0]:e.Lang.isObject(t,!0)?this.attributeSearch(t)[0]:t,!!this._data[i]},addOrUpdate:function(e){if(this.exists(e.id)){var t,i;Object.keys(e).forEach(function(s){t=this.attributes[s],i=e[s],t&&!t.readOnly&&"initOnly"!==t.writeOnce&&this.setValue(e.id,s,i)},this)}else this.add(e);return this.appContext.markAsNewlyFetched(this.name,e.id),this.markChildModelsAsNewlyFetched(e.id),this.proxy(e.id)},markChildModelsAsNewlyFetched:function(e){var t=this;this.getOwnedModels(e).forEach(function(e){e&&(t.appContext.markAsNewlyFetched(e.registry.name,e.id),e.markChildModelsAsNewlyFetched(e.id))})},getOwnedModels:function(t){var i,s,r,n=[];if(!t)return a.warn("`getOwnedModels` requires a model id.",{topic:this.name,id:t}),n;if(!this.exists(t))return n;this._ModelProxy||(this._ModelProxy=e.getModelProxyConstructor(this));for(i in this.attributes)(s=this.attributes[i]).isModel?(r=this.getValue(t,i))&&r.exists()&&n.push(r):(s.isListProxy||s.isCollection)&&(n=n.concat(this.getValue(t,i).getList().filter(function(e){return e&&e.isModel&&e.exists()})));return n},hasAttribute:function(e){return!!this.attributes[e]},toJSON:function(e){var t,i,s={};if(e)for(t in this.attributes)s[t]=this.getValue(e,t),s[t]&&(this.attributes[t].isModel||this.attributes[t].isListProxy||this.attributes[t].isCollection)&&(s[t]=s[t].toJSON());else for(i in this._data)s[i]=this.toJSON(i);return s},on:function(t,i,s,a){var r;return t||(t=null),r={eventName:i,fn:s,id:t,weak:a},this._subscribers.push(r),a&&(this.hasWeakSubscribers=!0),{detach:function(){var t=e.Array.indexOf(this._subscribers,r);this._subscribers.splice(t,1)}.bind(this)}},removeWeakSubscribers:function(){var e=this._subscribers.length;if(e)for(;e--;)this._subscribers[e].weak&&this._subscribers.splice(e,1);this.hasWeakSubscribers=!1},getCount:function(){return this._dataSize},getDefaultValue:function(e,t){var i,s;return"function"==typeof(i=this.attributes[t]).defaultFn&&(s=i.defaultFn.call(this,e)),void 0===s&&void 0!==i.defaultValue&&(s=i.defaultValue),s},_isDifferentValue:function(e,t,s,a){var r=this.attributes[t],n=r.getter;if(n&&(s=n.apply(this,[s,e])),void 0!==r.isListProxy&&r.isListProxy&&void 0!==a){if(s.hasMaxBoundary!==(void 0!==a.hasMaxBoundary&&a.hasMaxBoundary)||s.hasMinBoundary!==(void 0!==a.hasMinBoundary&&a.hasMinBoundary))return!0}else if(r.isCollection)return!0;return!i(s,a)},_calcListDiff:function(t,i){var s,a,r,n,o={added:null,removed:null};return s=t instanceof e.ListProxy||t instanceof e.PagedCollection?t.getList():t,a=i instanceof e.ListProxy||i instanceof e.PagedCollection?i.getList():i,r=a.reduce(function(e,t){return t&&t.id&&(e[t.id]=!0),e},{}),n=s.reduce(function(e,t){return t&&t.id&&(e[t.id]=!0),e},{}),o.added=s.filter(function(e){return e&&!r[e.id]}),o.removed=a.filter(function(e){return e&&!n[e.id]}),o},_getAttributesDerivedBy:function(t){return this._derivedCache||(this._derivedCache={},e.Object.each(this.attributes,function(t,i){t.derivedBy&&e.Lang.isArray(t.derivedBy)&&e.Array.each(t.derivedBy,function(e){this._derivedCache[e]||(this._derivedCache[e]=[]),this._derivedCache[e].push(i)},this)},this)),this._derivedCache[t]},_getAttributeValuesDerivedBy:function(t,i){var s=this._getAttributesDerivedBy(i),a={};return s&&s.length&&e.Array.each(s,function(e){a[e]=this.getValue(t,e)},this),a},_queueEvent:function(t,i){var s;this._eventQueue||(this._eventQueue=[]),(s=this._eventQueue).push({type:t,data:i}),this._eventPending||(this._eventPending=!0,setTimeout(function(){var t={};this._eventPending=!1,delete this._eventQueue,e.Array.each(s,function(e){var i=e.type,s=e.data,a=s.id;switch(i){case"modelsAdded":case"modelsRemoved":t[i]=t[i]||{},t[i][a]=s;break;case"valuesChanged":if(t.valuesChanged&&t.valuesChanged[a]&&t.valuesChanged[a][s.attrName]&&t.valuesChanged[a][s.attrName].newVal){t.valuesChanged[a][s.attrName].newVal=s.newVal,t.valuesChanged[a][s.attrName].derivedBy&&s.derivedBy&&(t.valuesChanged[a][s.attrName].derivedBy=t.valuesChanged[a][s.attrName].derivedBy.concat(s.derivedBy)),t.valuesChanged[a][s.attrName].chained&&!s.chained&&delete t.valuesChanged[a][s.attrName].chained;break}t.valuesChanged=t.valuesChanged||{},t.valuesChanged[a]=t.valuesChanged[a]||{},t.valuesChanged[a][s.attrName]=s}}),e.Object.each(t,function(e,t){this._fireEvent(t,e)},this)}.bind(this),0))},_fireEvent:function(t,i){e.Array.each(this._subscribers,function(e){e.eventName===t&&(e.id?i[e.id]&&e.fn.call(void 0,i[e.id]):e.fn.call(void 0,i))})},_chainEvents:function(t,i){var s,a,r=this.attributes[i];this._chainedEvents[t]=this._chainedEvents[t]||{},r.isModel?(this._chainedEvents[t][i]&&this._chainedEvents[t][i].detach(),a=this.getValue(t,i),this._chainedEvents[t][i]=a.on("valuesChanged",function(e){this._queueChainedEvent(t,i)}.bind(this))):(r.isListProxy||r.isCollection)&&(this._chainedEvents[t][i]&&e.Array.each(this._chainedEvents[t][i],function(e){e.detach()}),this._chainedEvents[t][i]=[],s=this.getValue(t,i),e.Array.each(s.getList(),function(e){e&&this._chainedEvents[t][i].push(e.on("valuesChanged",function(e){this._queueChainedEvent(t,i)}.bind(this)))},this))},_queueChainedEvent:function(t,i){var s,a=this.getValue(t,i);this._queueEvent("valuesChanged",{id:t,attrName:i,prevVal:a,newVal:a,chained:!0}),s=this._getAttributeValuesDerivedBy(t,i),e.Object.size(s)&&e.Object.each(s,function(e,s){this._queueEvent("valuesChanged",{id:t,attrName:s,newVal:e,derivedBy:[i],chained:!0})},this)},_deleteUnsaved:function(t,i){this._unsavedModels[t]&&this._unsavedModels[t][i]&&(delete this._unsavedModels[t][i],0===e.Object.size(this._unsavedModels[t])&&delete this._unsavedModels[t])},_setUnsaved:function(e,t,s,a,r){this._unsavedModels[e]&&this._unsavedModels[e][t]?i(s,this._unsavedModels[e][t].lastSavedVal)&&this._deleteUnsaved(e,t):(this._unsavedModels[e]=this._unsavedModels[e]||{},this._unsavedModels[e][t]={lastSavedVal:a,lastSavedValRaw:r})},_validateAttributes:function(){var t,i;t=["setter","getter","validator","defaultValue","defaultFn","derivedBy","readOnly","writeOnce","isModel","serialize","deserialize"],i=["isListProxy","isCollection","pageFetch","contextFetch","rangeFetch"],e.Object.each(this.attributes,function(s,r){e.Object.each(s,function(n,o){s.isListProxy||s.isCollection?-1===e.Array.indexOf(i,o)&&a.warn("Unknown property on collection attribute.",{topic:this.name,prop:o,attr:r}):-1===e.Array.indexOf(t,o)&&a.warn("Unknown property on attribute.",{topic:this.name,prop:o,attr:r})},this)},this)},_setDefaultRemoteMethods:function(){this.remote=this.remote||{},this.remote.create||(this.remote.create=function(t){return a.error("`remote.create` was called without being implemented.",{topic:this.name,attrs:t}),e.Promise.reject()}),this.remote.read||(this.remote.read=function(t){Object.keys(this.attributes).some(function(e){var t=this.attributes[e];if(!("id"===e||t.readOnly||t.isListProxy||t.isCollection||t.defaultValue||t.defaultFn))return!0},this),"object"!=typeof t&&(t={id:t});var i={id:t.id};return this.add(i),e.Promise.resolve(i)}),this.remote.update||(this.remote.update=function(t,i){return a.error("`remote.update` was called without being implemented.",{topic:this.name,id:t,attrs:i}),e.Promise.reject()}),this.remote.delete||(this.remote.delete=function(t){return a.error("`remote.delete` was called without being implemented.",{topic:this.name,id:t}),e.Promise.reject()})},remoteCreate:function(e){return this.remote.create.call(this,e)},remoteRead:function(e){return this.remote.read.call(this,e)},remoteUpdate:function(t){var i={},s=this;return this._unsavedModels[t]&&e.Object.each(this._unsavedModels[t],function(e,s){i[s]={newVal:this.getValue(t,s),prevVal:e.lastSavedVal}},this),e.Object.size(i)>0?this.remote.update.call(this,t,i).then(function(e){return s._unsavedModels={},e}):e.Promise.resolve()},remoteBatchUpdate:function(e,t){return this.remote.batchUpdate.call(this,e,t)},remoteDelete:function(e){var t=this;return this.remote.delete.call(this,e).then(function(){t.remove(e)})},getListPageByContinuation:function(t,i){var s,a,r,n,o,h,d,u,l,c,f=this,v=f.appContext,g=e.APIHelper.request.getRebootPhotoExtras();switch(f.name){case"photo-groups-models":s="group-pool-models",a="groups",r="flickr.photos.getGroups",n="groups.group",g+=","+e.APIHelper.request.getRebootGroupExtras();break;case"photo-sets-models":s="set-models",a="sets",r="flickr.photos.getSets",n="sets.set";break;case"photo-galleries-models":s="gallery-models",a="galleries",r="flickr.photos.getGalleries",n="galleries.gallery"}return r?f.exists(t)?(f.continuationKeys=f.continuationKeys||{},f.getMorePromises=f.getMorePromises||{},"-1"===(h=f.continuationKeys[t]||"0")?e.Promise.resolve({newItems:[],loadedAll:!0}):("0"===h&&(i+=f.getValue(t,a).getList().length),o={photo_id:t,extras:g,primary_photo_extras:"url_sq, url_t, url_s, url_m",continuation:h,per_page:i},u=t+"_"+h,(l=f.getMorePromises[u])?l:(c={apiResponse:v.callAPI(r,o,!0),contextRegistry:v.getModelRegistry(s),personRegistry:v.getModelRegistry("person-models")},"photo-groups-models"===f.name&&(c.groupRegistry=v.getModelRegistry("group-models")),f.getMorePromises[u]=new e.FlickrPromise(c).then(function(i){var s,r,o,h=[],l=i.apiResponse,c=i.contextRegistry,v=i.personRegistry,g=i.groupRegistry;return(r=n.split(".").reduce(function(t,i){return e.Lang.isObject(t)?t[i]:void 0},l))&&(e.Array.each(r,function(t){e.APIHelper.response.addContextToRegistry(t,c,v,g),h.push(c.proxy(t.id))}),h.length&&(o=f.getValue(t,a).getList().map(function(e){return e.getValue("id")}),(h=h.filter(function(e){return-1===o.indexOf(e.getValue("id"))})).length&&f.getValue(t,a).appendToListMulti(h))),void 0===(d=l[a].continuation)?d="-1":e.Lang.isNumber(d)&&(d+=""),s="-1"===d,f.continuationKeys[t]=d,delete f.getMorePromises[u],{newItems:h,loadedAll:s}},function(e){throw delete f.getMorePromises[u],e}),f.getMorePromises[u]))):e.Promise.reject("[api-helper] getListPageByContinuation was called for an ID that isn't in the registry: "+t):e.Promise.reject("[api-helper] getListPageByContinuation was called without an invalid registry type: "+f.name)},getBuriedValue:function(e,t){var i,s={};return(i=this.getValue(e,t))&&i.payload&&(s=i.payload),s},setBuriedValue:function(e,t,i,s){return this.setValue(e,t,{payload:i},s)}},e.mix(r.prototype,e.Localizable)},"@VERSION@",{requires:["flickr-promise","model-proxy","list-proxy","moment","paged-collection","localizable"]});